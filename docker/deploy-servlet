#!/bin/bash -
#===============================================================================
#
#          FILE: deploy-servlet
#
#         USAGE: ./deploy-servlet
#
#   DESCRIPTION: Script to compile the ch1 web app and deploy it to tomcat
#===============================================================================

set -o nounset                                  # Treat unset variables as an error

# Compile
cd /usr/local/src/app

javac -classpath $CATALINA_HOME/lib/servlet-api.jar:classes:. -d $CATALINA_HOME/webapps/ch1/WEB-INF/classes /usr/local/src/app/src/dev/andyosborne/Ch1Servlet.java

# Deployment to tomcat
cp -r classes $CATALINA_HOME/webapps/ch1/WEB-INF/

cp etc/web.xml $CATALINA_HOME/webapps/ch1/WEB-INF/

cp web/* $CATALINA_HOME/webapps/ch1/

cd -

# Start Tomcat
$CATALINA_HOME/bin/startup.sh

